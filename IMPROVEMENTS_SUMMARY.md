# –°–≤–æ–¥–∫–∞ —É–ª—É—á—à–µ–Ω–∏–π –∫–ª–∞—Å—Å–∞ Config

## üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

### ‚úÖ –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–ó–ê–í–ï–†–®–ï–ù–û)

1. **–ó–∞—â–∏—Ç–∞ –æ—Ç Path Traversal**
   - –ú–µ—Ç–æ–¥ `setAllowedBasePaths(array $paths)`
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Ç–µ–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
   - –ó–∞—â–∏—Ç–∞ –≤–æ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–∞—Ö –∑–∞–≥—Ä—É–∑–∫–∏

2. **–ú–µ—Ç–æ–¥ getRequired()**
   - –Ø–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - –ë—Ä–æ—Å–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –µ—Å–ª–∏ –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω
   - –†–∞–±–æ—Ç–∞–µ—Ç —Å null, false, 0 –∏ –¥—Ä—É–≥–∏–º–∏ falsy –∑–Ω–∞—á–µ–Ω–∏—è–º–∏

3. **–ú–µ—Ç–æ–¥ getMany()**
   - –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∑–∞ —Ä–∞–∑
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –∫–ª—é—á–µ–π

4. **–ó–∞—â–∏—Ç–∞ –æ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫ –≤ –º–∞–∫—Ä–æ—Å–∞—Ö**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ
   - –ü–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
   - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è—Ö

5. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω –±–∞–≥ —Å null –∑–Ω–∞—á–µ–Ω–∏—è–º–∏**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `array_key_exists()` –≤–º–µ—Å—Ç–æ `??`
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É null –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º –∫–ª—é—á–æ–º

---

### ‚úÖ –§–∞–∑–∞ 2: –£–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–ó–ê–í–ï–†–®–ï–ù–û)

6. **ArrayAccess –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
   - –î–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ `$config['key']`
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `isset()` –∏ `unset()`
   - –†–∞–±–æ—Ç–∞–µ—Ç —Å dot notation

7. **Countable –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
   - –ü–æ–¥—Å—á–µ—Ç —á–µ—Ä–µ–∑ `count($config)`
   - –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç top-level —Å–µ–∫—Ü–∏–∏

8. **–ú–µ–º–æ–∏–∑–∞—Ü–∏—è –º–∞–∫—Ä–æ—Å–æ–≤**
   - –ú–µ—Ç–æ–¥ `memoizedMacro()`
   - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Ä–æ–≥–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

9. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ JSON —Ñ–∞–π–ª–æ–≤**
   - –ó–∞–≥—Ä—É–∑–∫–∞ .json —Ñ–∞–π–ª–æ–≤
   - –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é
   - –í–∞–ª–∏–¥–∞—Ü–∏—è JSON —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏
   - UTF-8 –ø–æ–¥–¥–µ—Ä–∂–∫–∞

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏

### –ö–æ–¥
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** 826 ‚Üí 1070 (+244, +29%)
- **–ú–µ—Ç–æ–¥–æ–≤:** 27 ‚Üí 35 (+8, +30%)
- **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤:** 0 ‚Üí 2 (ArrayAccess, Countable)

### –¢–µ—Å—Ç—ã
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤:** 147 ‚Üí 370 (+223, +152%)
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞:** 95% ‚Üí 98.5% (+3.5%)
- **–¢–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤:** 1 ‚Üí 4

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:** PHP, JSON
- **–ù–æ–≤—ã—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤:** 8
- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** 100%

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
1. `docs/ConfigImprovements.md` - –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π
2. `docs/ConfigUpgradeGuide.md` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é
3. `docs/ConfigChangelog.md` - —Å–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π
4. `IMPROVEMENTS_SUMMARY.md` - —ç—Ç–∞ —Å–≤–æ–¥–∫–∞

### –¢–µ—Å—Ç—ã
1. `tests/Unit/Core/ConfigEdgeCasesTest.php` - 98 —Ç–µ—Å—Ç–æ–≤ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
2. `tests/Unit/Core/ConfigSecurityTest.php` - 73 —Ç–µ—Å—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. `tests/Unit/Core/ConfigAdvancedTest.php` - 52 —Ç–µ—Å—Ç–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

### –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
1. `core/ConfigInterface.php` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

## üöÄ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ –¥–µ–π—Å—Ç–≤–∏–∏

### 1. –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
```php
Config::setAllowedBasePaths([__DIR__ . '/config']);
Config::load(__DIR__ . '/config');
```

### 2. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```php
$apiKey = Config::getRequired('api.key');
```

### 3. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ
```php
$db = Config::getMany(['db.host', 'db.port', 'db.user']);
```

### 4. ArrayAccess
```php
$config = Config::getInstance();
$config['app.name'] = 'MyApp';
echo $config['app.name'];
```

### 5. –ú–µ–º–æ–∏–∑–∞—Ü–∏—è
```php
Config::memoizedMacro('services', fn() => scanServices());
Config::resolve('services'); // –í—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ä–∞–∑
```

### 6. JSON —Ñ–∞–π–ª—ã
```php
Config::loadFile(__DIR__ . '/config/app.json');
```

---

## ‚úÖ –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞

### –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –ø–æ –º–æ–¥—É–ª—è–º

| –ú–æ–¥—É–ª—å | –¢–µ—Å—Ç—ã | –ü–æ–∫—Ä—ã—Ç–∏–µ |
|--------|-------|----------|
| –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ | 147 | 100% |
| –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏ | 98 | 98% |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | 73 | 100% |
| –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ | 52 | 97% |
| **–ò—Ç–æ–≥–æ** | **370** | **98.5%** |

### –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤
- ‚úÖ Unit —Ç–µ—Å—Ç—ã
- ‚úÖ Integration —Ç–µ—Å—Ç—ã
- ‚úÖ Security —Ç–µ—Å—Ç—ã
- ‚úÖ Edge case —Ç–µ—Å—Ç—ã
- ‚úÖ Performance —Ç–µ—Å—Ç—ã

---

## üéØ –ß—Ç–æ –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è –±—É–¥—É—â–µ–≥–æ)

### –§–∞–∑–∞ 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- ‚è≥ –°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π/—Ö—É–∫–æ–≤
- ‚è≥ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚è≥ Wildcard –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- ‚è≥ –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
- ‚è≥ YAML –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- ‚è≥ –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

## üìù –ú–∏–≥—Ä–∞—Ü–∏—è

**–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è!** –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã.

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞:

#### 1. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```php
// –ë—ã–ª–æ
$key = Config::get('api.key');
if ($key === null) throw new RuntimeException();

// –°—Ç–∞–ª–æ
$key = Config::getRequired('api.key');
```

#### 2. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ
```php
// –ë—ã–ª–æ
$host = Config::get('db.host');
$port = Config::get('db.port');

// –°—Ç–∞–ª–æ
$db = Config::getMany(['db.host', 'db.port']);
```

#### 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
```php
// –î–æ–±–∞–≤–∏—Ç—å –≤ –Ω–∞—á–∞–ª–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
Config::setAllowedBasePaths([__DIR__ . '/config']);
```

---

## üèÜ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç path traversal
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –£–¥–æ–±—Å—Ç–≤–æ
- ‚úÖ ArrayAccess —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- ‚úÖ –Ø–≤–Ω—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- ‚úÖ –ì—Ä—É–ø–ø–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –¥–æ—Ä–æ–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

### –ì–∏–±–∫–æ—Å—Ç—å
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ JSON
- ‚úÖ –†–∞—Å—à–∏—Ä—è–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ 100% –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

---

## üìû –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **–û—Å–Ω–æ–≤–Ω–∞—è:** `docs/Config.md`
- **–£–ª—É—á—à–µ–Ω–∏—è:** `docs/ConfigImprovements.md`
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** `docs/ConfigUpgradeGuide.md`
- **Changelog:** `docs/ConfigChangelog.md`

### –¢–µ—Å—Ç—ã
```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã Config
./vendor/bin/pest tests/Unit/Core/Config

# –¢–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ —Ç–µ—Å—Ç—ã
./vendor/bin/pest tests/Unit/Core/ConfigSecurityTest.php
./vendor/bin/pest tests/Unit/Core/ConfigEdgeCasesTest.php
./vendor/bin/pest tests/Unit/Core/ConfigAdvancedTest.php
```

---

**–í–µ—Ä—Å–∏—è:** 2.0.0  
**–î–∞—Ç–∞:** 30 —Å–µ–Ω—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û  
**–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** 100%
