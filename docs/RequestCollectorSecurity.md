# Request Collector - Security Features

## ๐ ะะตะทะพะฟะฐัะฝะพััั ะฒ Production ัะตะถะธะผะต

Request Collector ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฐะดะฐะฟัะธััะตั ััะพะฒะตะฝั ะดะตัะฐะปะธะทะฐัะธะธ ะธะฝัะพัะผะฐัะธะธ ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ะพะบััะถะตะฝะธั ะฟัะธะปะพะถะตะฝะธั.

## ะะตะถะธะผั ัะฐะฑะพัั

### Development Mode (ัะฐะทัะฐะฑะพัะบะฐ)

ะ ัะตะถะธะผะต ัะฐะทัะฐะฑะพัะบะธ (`APP_ENV=development`) Request Collector ะฟะพะบะฐะทัะฒะฐะตั **ะฟะพะปะฝัั ะธะฝัะพัะผะฐัะธั**:

โ ะัะต GET ะฟะฐัะฐะผะตััั  
โ ะัะต POST ะดะฐะฝะฝัะต  
โ ะัะต cookies  
โ ะัะต HTTP headers  
โ **ะัะต server variables** (ะบัะพะผะต ะบัะธัะธัะตัะบะธ ััะฒััะฒะธัะตะปัะฝัั)  

```
Server Variables
โโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโ
โ Key                 โ Value                โ
โโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโค
โ DOCUMENT_ROOT       โ /var/www/html        โ
โ REMOTE_ADDR         โ 127.0.0.1            โ
โ SERVER_NAME         โ localhost            โ
โ PATH                โ /usr/bin:/bin        โ
โ PHP_SELF            โ /index.php           โ
โ SCRIPT_FILENAME     โ /var/www/index.php   โ
โ PHP_AUTH_PW         โ ***HIDDEN***         โ  โ ะัะตะณะดะฐ ัะบัััะพ
โโโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโโ
```

### Production Mode (ะฟัะพะดะฐะบัะฝ)

ะ production ัะตะถะธะผะต (`APP_ENV=production`) Request Collector **ัะบััะฒะฐะตั ััะฒััะฒะธัะตะปัะฝัะต ะดะฐะฝะฝัะต**:

โ ะะฐะทะพะฒัะต ะฟะฐัะฐะผะตััั ะทะฐะฟัะพัะฐ (METHOD, URI, TIME)  
โ GET/POST/Cookies/Headers - ะฟะพะบะฐะทัะฒะฐัััั ะฟะพะปะฝะพัััั  
๐ **Server Variables - ัะบัััั** (ะบัะพะผะต ะฑะตะทะพะฟะฐัะฝัั)  

```
๐ PRODUCTION MODE

โ๏ธ Production Mode: Sensitive server variables are hidden for security reasons.
    Only safe variables are shown.

Server Variables
โโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Key                 โ Value                                โ
โโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ REQUEST_METHOD      โ GET                                  โ  โ ะะตะทะพะฟะฐัะฝะพ
โ REQUEST_URI         โ /demo                                โ  โ ะะตะทะพะฟะฐัะฝะพ
โ SERVER_PROTOCOL     โ HTTP/1.1                             โ  โ ะะตะทะพะฟะฐัะฝะพ
โ DOCUMENT_ROOT       โ ***HIDDEN (PRODUCTION MODE)***       โ  โ ะกะบัััะพ
โ REMOTE_ADDR         โ ***HIDDEN (PRODUCTION MODE)***       โ  โ ะกะบัััะพ
โ SERVER_NAME         โ ***HIDDEN (PRODUCTION MODE)***       โ  โ ะกะบัััะพ
โ PATH                โ ***HIDDEN (PRODUCTION MODE)***       โ  โ ะกะบัััะพ
โ PHP_SELF            โ ***HIDDEN (PRODUCTION MODE)***       โ  โ ะกะบัััะพ
โ SCRIPT_FILENAME     โ ***HIDDEN (PRODUCTION MODE)***       โ  โ ะกะบัััะพ
โ PHP_AUTH_PW         โ ***HIDDEN***                         โ  โ ะัะตะณะดะฐ ัะบัััะพ
โโโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ะขะธะฟั ะทะฐัะธัั ะดะฐะฝะฝัั

### 1. ะัะตะณะดะฐ ัะบััััะต ะฟะตัะตะผะตะฝะฝัะต (ะฒัะต ัะตะถะธะผั)

ะญัะธ ะฟะตัะตะผะตะฝะฝัะต **ะฒัะตะณะดะฐ** ัะบัััั ะฝะตะทะฐะฒะธัะธะผะพ ะพั ัะตะถะธะผะฐ:

```php
'PHP_AUTH_PW'           โ ***HIDDEN***
'PHP_AUTH_USER'         โ ***HIDDEN***
'HTTP_AUTHORIZATION'    โ ***HIDDEN***
'DATABASE_URL'          โ ***HIDDEN***
'DB_PASSWORD'           โ ***HIDDEN***
'DB_USERNAME'           โ ***HIDDEN***
'API_KEY'               โ ***HIDDEN***
'SECRET_KEY'            โ ***HIDDEN***
'AWS_SECRET'            โ ***HIDDEN***
'STRIPE_SECRET'         โ ***HIDDEN***
```

### 2. ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฟัะตะดะตะปะตะฝะธะต ััะฒััะฒะธัะตะปัะฝัั ะดะฐะฝะฝัั

Request Collector ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะบััะฒะฐะตั ะฟะตัะตะผะตะฝะฝัะต, ัะพะดะตัะถะฐัะธะต ะฒ ะธะผะตะฝะธ:

- `PASSWORD`
- `SECRET`
- `TOKEN`
- `KEY`
- `AUTH`
- `CREDENTIAL`

**ะัะธะผะตัั:**
```
MY_API_KEY          โ ***HIDDEN***
JWT_TOKEN           โ ***HIDDEN***
DB_PASSWORD         โ ***HIDDEN***
AUTH_SECRET         โ ***HIDDEN***
OAUTH_CREDENTIAL    โ ***HIDDEN***
```

### 3. ะะตะทะพะฟะฐัะฝัะต ะฟะตัะตะผะตะฝะฝัะต ะฒ Production

ะ production ัะตะถะธะผะต ัะฐะทัะตัะตะฝะพ ะฟะพะบะฐะทัะฒะฐัั ัะพะปัะบะพ ััะธ ะฟะตัะตะผะตะฝะฝัะต:

```php
โ REQUEST_METHOD       // HTTP ะผะตัะพะด
โ REQUEST_URI          // URI ะทะฐะฟัะพัะฐ
โ REQUEST_TIME         // ะัะตะผั ะทะฐะฟัะพัะฐ
โ REQUEST_TIME_FLOAT   // ะัะตะผั ั ะผะธะบัะพัะตะบัะฝะดะฐะผะธ
โ SERVER_PROTOCOL      // HTTP/1.1, HTTP/2
โ GATEWAY_INTERFACE    // CGI/1.1
โ SERVER_SOFTWARE      // Apache, Nginx
โ QUERY_STRING         // Query string
โ CONTENT_TYPE         // Content-Type
โ CONTENT_LENGTH       // Content-Length
```

ะัะต ะพััะฐะปัะฝัะต ะฟะตัะตะผะตะฝะฝัะต ัะบััะฒะฐัััั ะบะฐะบ `***HIDDEN (PRODUCTION MODE)***`.

## ะัะธะผะตัั

### Development Mode

```bash
export APP_ENV=development
php -S localhost:8000
```

ะัะบัะพะนัะต `http://localhost:8000/demo` ะธ ะฟะพัะผะพััะธัะต ะฝะฐ Server Variables:
- ะัะต ะฟะตัะตะผะตะฝะฝัะต ะฒะธะดะฝั
- ะขะพะปัะบะพ ะบัะธัะธัะตัะบะธ ััะฒััะฒะธัะตะปัะฝัะต ัะบัััั (*_PASSWORD, *_SECRET, etc.)
- ะะพะปะฝะฐั ะธะฝัะพัะผะฐัะธั ะดะปั ะพัะปะฐะดะบะธ

### Production Mode

```bash
export APP_ENV=production
php -S localhost:8000
```

ะัะบัะพะนัะต `http://localhost:8000/demo` ะธ ะฟะพัะผะพััะธัะต ะฝะฐ Server Variables:
- ๐ ะัะฐัะฝัะน badge "PRODUCTION MODE"
- โ๏ธ ะัะตะดัะฟัะตะถะดะฐััะตะต ัะพะพะฑัะตะฝะธะต
- ะะพะปััะธะฝััะฒะพ ะฟะตัะตะผะตะฝะฝัั ัะบัััะพ
- ะะธะดะฝั ัะพะปัะบะพ ะฑะตะทะพะฟะฐัะฝัะต ะฟะฐัะฐะผะตััั

## ะกัะฐะฒะฝะธัะตะปัะฝะฐั ัะฐะฑะปะธัะฐ

| ะะตัะตะผะตะฝะฝะฐั          | Development | Production |
|---------------------|-------------|------------|
| REQUEST_METHOD      | โ ะะธะดะฝะฐ     | โ ะะธะดะฝะฐ    |
| REQUEST_URI         | โ ะะธะดะฝะฐ     | โ ะะธะดะฝะฐ    |
| DOCUMENT_ROOT       | โ ะะธะดะฝะฐ     | ๐ ะกะบัััะฐ   |
| REMOTE_ADDR         | โ ะะธะดะฝะฐ     | ๐ ะกะบัััะฐ   |
| SERVER_NAME         | โ ะะธะดะฝะฐ     | ๐ ะกะบัััะฐ   |
| SCRIPT_FILENAME     | โ ะะธะดะฝะฐ     | ๐ ะกะบัััะฐ   |
| PATH                | โ ะะธะดะฝะฐ     | ๐ ะกะบัััะฐ   |
| PHP_SELF            | โ ะะธะดะฝะฐ     | ๐ ะกะบัััะฐ   |
| PHP_AUTH_PW         | ๐ ะกะบัััะฐ    | ๐ ะกะบัััะฐ   |
| DB_PASSWORD         | ๐ ะกะบัััะฐ    | ๐ ะกะบัััะฐ   |

## ะะธะทัะฐะปัะฝะฐั ะธะฝะดะธะบะฐัะธั

### Production Mode Badge

ะ production ัะตะถะธะผะต ะฒ ะทะฐะณะพะปะพะฒะบะต ัะตะบัะธะธ Server Variables ะพัะพะฑัะฐะถะฐะตััั ะบัะฐัะฝัะน badge:

```html
๐ Server Variables ๐ PRODUCTION MODE
```

### Warning Message

ะะตัะตะด ัะฐะฑะปะธัะตะน ะฟะพะบะฐะทัะฒะฐะตััั ะฟัะตะดัะฟัะตะถะดะตะฝะธะต:

```
โ๏ธ Production Mode: Sensitive server variables are hidden 
   for security reasons. Only safe variables are shown.
```

## ะะฐัััะพะนะบะฐ ัะฟะธัะบะฐ ะฑะตะทะพะฟะฐัะฝัั ะฟะตัะตะผะตะฝะฝัั

ะัะปะธ ะฒั ัะพัะธัะต ะธะทะผะตะฝะธัั ัะฟะธัะพะบ ัะฐะทัะตัะตะฝะฝัั ะฟะตัะตะผะตะฝะฝัั ะฒ production, ะพััะตะดะฐะบัะธััะนัะต ะผะฐััะธะฒ `$safeInProduction` ะฒ ะผะตัะพะดะต `filterServer()`:

```php
// core/DebugToolbar/Collectors/RequestCollector.php

private function filterServer(array $server): array
{
    // ...
    
    $safeInProduction = [
        'REQUEST_METHOD',
        'REQUEST_URI',
        'REQUEST_TIME',
        'REQUEST_TIME_FLOAT',
        'SERVER_PROTOCOL',
        // ะะพะฑะฐะฒััะต ัะฒะพะธ ะฑะตะทะพะฟะฐัะฝัะต ะฟะตัะตะผะตะฝะฝัะต
        'MY_SAFE_VAR',
        'ANOTHER_SAFE_VAR',
    ];
    
    // ...
}
```

## ะะพะฑะฐะฒะปะตะฝะธะต ััะฒััะฒะธัะตะปัะฝัั ะฟะตัะตะผะตะฝะฝัั

ะงัะพะฑั ะดะพะฑะฐะฒะธัั ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ะฒัะตะณะดะฐ ัะบััััะต ะฟะตัะตะผะตะฝะฝัะต:

```php
$alwaysHidden = [
    'PHP_AUTH_PW',
    'PHP_AUTH_USER',
    'HTTP_AUTHORIZATION',
    // ะะพะฑะฐะฒััะต ัะฒะพะธ
    'MY_SECRET_VAR',
    'CUSTOM_API_KEY',
];
```

## ะะฐััะตัะฝั ััะฒััะฒะธัะตะปัะฝัั ะดะฐะฝะฝัั

ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฟัะตะดะตะปะตะฝะธะต ัะฐะฑะพัะฐะตั ะฟะพ ะฟะฐััะตัะฝะฐะผ:

```php
$patterns = [
    'PASSWORD',
    'SECRET', 
    'TOKEN',
    'KEY',
    'AUTH',
    'CREDENTIAL'
];
```

ะะพะฑะฐะฒััะต ัะฒะพะธ ะฟะฐััะตัะฝั ะฒ ะผะตัะพะด `isSensitiveKey()`:

```php
$patterns = [
    'PASSWORD',
    'SECRET',
    'TOKEN',
    'KEY',
    'AUTH',
    'CREDENTIAL',
    'PRIVATE',  // ะะฐั ะฟะฐััะตัะฝ
    'SENSITIVE', // ะะฐั ะฟะฐััะตัะฝ
];
```

## Best Practices

### โ ะะตะบะพะผะตะฝะดัะตััั

1. **ะัะตะณะดะฐ ะธัะฟะพะปัะทัะนัะต production ัะตะถะธะผ ะฝะฐ ะฑะพะตะฒัั ัะตัะฒะตัะฐั**
   ```bash
   APP_ENV=production
   ```

2. **ะัะบะปััะฐะนัะต Debug Toolbar ะฒ production**
   ```bash
   APP_DEBUG=false
   ```

3. **ะัะพะฒะตััะนัะต ะปะพะณะธ ะฝะฐ ะฟัะตะดะผะตั ััะตัะตะบ ะดะฐะฝะฝัั**
   ```bash
   grep -r "PASSWORD\|SECRET\|TOKEN" storage/logs/
   ```

4. **ะัะฟะพะปัะทัะนัะต .env ัะฐะนะปั ะดะปั ััะฒััะฒะธัะตะปัะฝัั ะดะฐะฝะฝัั**
   ```bash
   # .env
   DB_PASSWORD=secret123
   API_KEY=your-api-key
   ```

### โ ะะต ัะตะบะพะผะตะฝะดัะตััั

1. โ ะััะฐะฒะปััั Debug Toolbar ะฒะบะปััะตะฝะฝัะผ ะฒ production
2. โ ะฅัะฐะฝะธัั ะฟะฐัะพะปะธ ะฒ ะบะพะดะต
3. โ ะะพะผะผะธัะธัั .env ัะฐะนะปั ะฒ git
4. โ ะะพะณะธัะพะฒะฐัั ััะฒััะฒะธัะตะปัะฝัะต ะดะฐะฝะฝัะต

## ะขะตััะธัะพะฒะฐะฝะธะต ะฑะตะทะพะฟะฐัะฝะพััะธ

### ะขะตัั 1: ะัะพะฒะตัะบะฐ ัะบัััะธั ะฟะฐัะพะปะตะน

```bash
# Development
curl http://localhost:8000/demo | grep "PHP_AUTH_PW"
# ะะพะปะถะฝะพ ะฟะพะบะฐะทะฐัั: ***HIDDEN***

# Production
export APP_ENV=production
curl http://localhost:8000/demo | grep "PHP_AUTH_PW"
# ะะพะปะถะฝะพ ะฟะพะบะฐะทะฐัั: ***HIDDEN***
```

### ะขะตัั 2: ะัะพะฒะตัะบะฐ production ัะตะถะธะผะฐ

```bash
export APP_ENV=production
curl http://localhost:8000/demo | grep "PRODUCTION MODE"
# ะะพะปะถะฝะพ ะฝะฐะนัะธ badge ะธ warning
```

### ะขะตัั 3: ะัะพะฒะตัะบะฐ ัะธะปัััะฐัะธะธ

```bash
# ะฃััะฐะฝะพะฒะธัะต ัะตััะพะฒัั ะฟะตัะตะผะตะฝะฝัั
export MY_SECRET_KEY="supersecret"

# Development - ะดะพะปะถะฝะฐ ะฑััั ัะบัััะฐ
curl http://localhost:8000/demo | grep "MY_SECRET_KEY"
# ะะตะทัะปััะฐั: ***HIDDEN***

# Production - ัะพะถะต ัะบัััะฐ
export APP_ENV=production
curl http://localhost:8000/demo | grep "MY_SECRET_KEY"
# ะะตะทัะปััะฐั: ***HIDDEN***
```

## Compliance & Regulations

Request Collector ะฟะพะผะพะณะฐะตั ัะพะพัะฒะตัััะฒะพะฒะฐัั ััะตะฑะพะฒะฐะฝะธัะผ:

- โ **GDPR** - ะฝะต ะฟะพะบะฐะทัะฒะฐะตั IP ะฐะดัะตัะฐ ะฒ production
- โ **PCI DSS** - ัะบััะฒะฐะตั ะฟััะธ ะบ ัะฐะนะปะฐะผ ะธ ะบะพะฝัะธะดะตะฝัะธะฐะปัะฝัะต ะดะฐะฝะฝัะต
- โ **OWASP** - ะทะฐัะธัะฐ ะพั ััะตัะบะธ ะธะฝัะพัะผะฐัะธะธ
- โ **ISO 27001** - ะบะพะฝััะพะปั ะดะพัััะฟะฐ ะบ ััะฒััะฒะธัะตะปัะฝัะผ ะดะฐะฝะฝัะผ

## ะะฐะบะปััะตะฝะธะต

Request Collector ะพะฑะตัะฟะตัะธะฒะฐะตั **ะผะฝะพะณะพััะพะฒะฝะตะฒัั ะทะฐัะธัั** ััะฒััะฒะธัะตะปัะฝัั ะดะฐะฝะฝัั:

1. ๐ก๏ธ **ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฟัะตะดะตะปะตะฝะธะต** ััะฒััะฒะธัะตะปัะฝัั ะฟะตัะตะผะตะฝะฝัั
2. ๐ **Production ัะตะถะธะผ** ั ะผะธะฝะธะผะฐะปัะฝะพะน ะธะฝัะพัะผะฐัะธะตะน
3. โ๏ธ **ะะธะทัะฐะปัะฝะฐั ะธะฝะดะธะบะฐัะธั** ัะตะถะธะผะฐ ะฑะตะทะพะฟะฐัะฝะพััะธ
4. โ **ะะตะปัะน ัะฟะธัะพะบ** ะฑะตะทะพะฟะฐัะฝัั ะฟะตัะตะผะตะฝะฝัั
5. ๐ซ **ะงะตัะฝัะน ัะฟะธัะพะบ** ะฒัะตะณะดะฐ ัะบััััั ะดะฐะฝะฝัั

**ะะตะทะพะฟะฐัะฝะพััั ะฟะพ ัะผะพะปัะฐะฝะธั!** ๐

