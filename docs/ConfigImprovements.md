# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –∫–ª–∞—Å—Å–∞ Config

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚úÖ

–í–∞—à –∫–ª–∞—Å—Å `Core\Config` —É–∂–µ –∏–º–µ–µ—Ç –æ—Ç–ª–∏—á–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É:
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ dot notation
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –ú–∞–∫—Ä–æ—Å—ã –¥–ª—è lazy evaluation
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–ª—è immutability
- ‚úÖ –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- ‚úÖ Environment-specific –∫–æ–Ω—Ñ–∏–≥–∏
- ‚úÖ –û—Ç–ª–∏—á–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ (~95%)

---

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è üöÄ

### 1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (High Priority)

#### 1.1 –ó–∞—â–∏—Ç–∞ –æ—Ç Path Traversal
**–ü—Ä–æ–±–ª–µ–º–∞:** –í–æ–∑–º–æ–∂–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤–Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

**–†–µ—à–µ–Ω–∏–µ:**
```php
protected static function validatePath(string $path, string $basePath): bool
{
    $realPath = realpath($path);
    $realBasePath = realpath($basePath);
    
    if ($realPath === false || $realBasePath === false) {
        return false;
    }
    
    return str_starts_with($realPath, $realBasePath);
}
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
```php
public static function loadFile(string $filePath): void
{
    $realPath = realpath($filePath);
    
    if ($realPath === false) {
        throw new InvalidArgumentException("File not found: {$filePath}");
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—ã—Ö–æ–¥ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
    $allowedBasePath = self::$configBasePath ?? getcwd();
    if (!self::validatePath($realPath, $allowedBasePath)) {
        throw new SecurityException("Path traversal detected: {$filePath}");
    }
    
    // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

#### 1.2 –ó–∞—â–∏—Ç–∞ –æ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫ –≤ –º–∞–∫—Ä–æ—Å–∞—Ö
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–∞–∫—Ä–æ—Å –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å —Å–∞–º —Å–µ–±—è, —Å–æ–∑–¥–∞–≤–∞—è –±–µ—Å–∫–æ–Ω–µ—á–Ω—É—é —Ä–µ–∫—É—Ä—Å–∏—é.

**–†–µ—à–µ–Ω–∏–µ:**
```php
protected static array $resolvingMacros = [];

public static function resolve(string $key, mixed $default = null): mixed
{
    if (isset(self::$resolvingMacros[$key])) {
        throw new RuntimeException("Circular macro reference detected: {$key}");
    }
    
    $value = self::get($key, $default);
    
    if (is_callable($value) && self::isMacro($key)) {
        self::$resolvingMacros[$key] = true;
        try {
            $result = $value();
        } finally {
            unset(self::$resolvingMacros[$key]);
        }
        return $result;
    }
    
    return $value;
}
```

---

### 2. –£–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (High Priority)

#### 2.1 ArrayAccess Interface
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –ë–æ–ª–µ–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```php
class Config implements ArrayAccess, Countable
{
    public function offsetExists($offset): bool
    {
        return self::has($offset);
    }
    
    public function offsetGet($offset): mixed
    {
        return self::get($offset);
    }
    
    public function offsetSet($offset, $value): void
    {
        self::set($offset, $value);
    }
    
    public function offsetUnset($offset): void
    {
        self::forget($offset);
    }
    
    public function count(): int
    {
        return count(self::$items);
    }
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```php
// –í–º–µ—Å—Ç–æ Config::get('database.host')
$host = Config::getInstance()['database.host'];

// –í–º–µ—Å—Ç–æ Config::set('app.name', 'MyApp')
Config::getInstance()['app.name'] = 'MyApp';

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è
if (isset(Config::getInstance()['cache.driver'])) {
    // ...
}
```

#### 2.2 –ú–µ—Ç–æ–¥ getRequired()
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –Ø–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```php
/**
 * Gets a required configuration value, throws if missing
 *
 * @param string $key The configuration key
 * @return mixed The configuration value
 * @throws RuntimeException If key doesn't exist
 */
public static function getRequired(string $key): mixed
{
    if (!self::has($key)) {
        throw new RuntimeException("Required configuration key missing: {$key}");
    }
    
    return self::get($key);
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```php
// –í–º–µ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤—Ä—É—á–Ω—É—é:
$apiKey = Config::get('api.key');
if ($apiKey === null) {
    throw new RuntimeException('API key is required');
}

// –¢–µ–ø–µ—Ä—å:
$apiKey = Config::getRequired('api.key');
```

#### 2.3 –ú–µ—Ç–æ–¥ getMany()
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```php
/**
 * Gets multiple configuration values at once
 *
 * @param array $keys Array of configuration keys
 * @param mixed $default Default value for missing keys
 * @return array Array of values keyed by original keys
 */
public static function getMany(array $keys, mixed $default = null): array
{
    $result = [];
    foreach ($keys as $key) {
        $result[$key] = self::get($key, $default);
    }
    return $result;
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```php
// –ü–æ–ª—É—á–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π
$config = Config::getMany([
    'database.host',
    'database.port',
    'database.username',
]);
```

---

### 3. –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (Medium Priority)

#### 3.1 –ü–æ–¥–¥–µ—Ä–∂–∫–∞ JSON —Ñ–∞–π–ª–æ–≤
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```php
public static function loadFile(string $filePath): void
{
    if (!file_exists($filePath)) {
        throw new InvalidArgumentException("File not found: {$filePath}");
    }
    
    $extension = pathinfo($filePath, PATHINFO_EXTENSION);
    $key = basename($filePath, '.' . $extension);
    
    $config = match($extension) {
        'php' => require $filePath,
        'json' => json_decode(file_get_contents($filePath), true),
        default => throw new RuntimeException("Unsupported file format: {$extension}")
    };
    
    if (!is_array($config)) {
        throw new RuntimeException("Configuration file must contain an array: {$filePath}");
    }
    
    // ... merge logic
}
```

#### 3.2 –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –º–∞–∫—Ä–æ—Å–æ–≤
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –¥–æ—Ä–æ–≥–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```php
protected static array $memoizedMacros = [];

/**
 * Registers a memoized macro (result cached after first execution)
 */
public static function memoizedMacro(string $key, callable $callback): void
{
    self::ensureNotLocked();
    
    $memoized = function() use ($key, $callback) {
        if (!isset(self::$memoizedMacros[$key])) {
            self::$memoizedMacros[$key] = $callback();
        }
        return self::$memoizedMacros[$key];
    };
    
    self::$macros[$key] = $memoized;
    self::set($key, $memoized);
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```php
// –û–±—ã—á–Ω—ã–π –º–∞–∫—Ä–æ - –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑
Config::macro('timestamp', fn() => microtime(true));

// –ú–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞–∫—Ä–æ - –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑
Config::memoizedMacro('app.timezone', function() {
    // –î–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
    return detectTimezone(); 
});
```

#### 3.3 –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –†–∞–Ω–Ω–µ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```php
protected static array $validators = [];

/**
 * Registers a validator for a configuration key
 */
public static function validator(string $key, callable $validator): void
{
    self::$validators[$key] = $validator;
}

/**
 * Validates all registered validators
 * @throws ValidationException
 */
public static function validate(): void
{
    $errors = [];
    
    foreach (self::$validators as $key => $validator) {
        try {
            $value = self::get($key);
            if (!$validator($value)) {
                $errors[] = "Validation failed for key: {$key}";
            }
        } catch (\Throwable $e) {
            $errors[] = "Validation error for {$key}: {$e->getMessage()}";
        }
    }
    
    if (!empty($errors)) {
        throw new ValidationException(implode(', ', $errors));
    }
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```php
// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤
Config::validator('database.port', fn($v) => is_int($v) && $v > 0 && $v < 65536);
Config::validator('app.debug', fn($v) => is_bool($v));
Config::validator('api.key', fn($v) => is_string($v) && strlen($v) > 10);

// –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
Config::load(__DIR__ . '/config');
Config::validate(); // –ë—Ä–æ—Å–∏—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
```

#### 3.4 –°–æ–±—ã—Ç–∏—è/–•—É–∫–∏
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å –±–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```php
protected static array $listeners = [];

/**
 * Registers an event listener
 */
public static function on(string $event, callable $callback): void
{
    self::$listeners[$event][] = $callback;
}

/**
 * Fires an event
 */
protected static function fire(string $event, array $data = []): void
{
    if (isset(self::$listeners[$event])) {
        foreach (self::$listeners[$event] as $callback) {
            $callback($data);
        }
    }
}

// –í –º–µ—Ç–æ–¥–µ set():
public static function set(string $key, mixed $value): void
{
    self::ensureNotLocked();
    
    $oldValue = self::get($key);
    
    // ... set logic
    
    self::fire('config.changed', [
        'key' => $key,
        'old' => $oldValue,
        'new' => $value,
    ]);
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```php
// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
Config::on('config.changed', function($data) {
    Log::info("Config changed: {$data['key']}");
});

// –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
Config::on('config.changed', function($data) {
    if (str_starts_with($data['key'], 'cache.')) {
        Cache::flush();
    }
});
```

---

### 4. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (Low Priority)

#### 4.1 –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∫–æ–Ω—Ñ–∏–≥–æ–≤.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```php
protected static array $lazyFiles = [];

/**
 * Registers a file for lazy loading
 */
public static function registerLazy(string $key, string $filePath): void
{
    self::$lazyFiles[$key] = $filePath;
}

/**
 * Modified get() with lazy loading
 */
public static function get(string $key, mixed $default = null): mixed
{
    // Check if we need to lazy load
    $topLevelKey = explode('.', $key)[0];
    
    if (isset(self::$lazyFiles[$topLevelKey]) && !isset(self::$items[$topLevelKey])) {
        self::loadFile(self::$lazyFiles[$topLevelKey]);
        unset(self::$lazyFiles[$topLevelKey]);
    }
    
    // ... normal get logic
}
```

#### 4.2 –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å dot notation
**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ —Å —Ç–æ—á–∫–∞–º–∏.

**–†–µ—à–µ–Ω–∏–µ:**
```php
protected static array $pathCache = [];

protected static function parsePath(string $key): array
{
    if (!isset(self::$pathCache[$key])) {
        self::$pathCache[$key] = explode('.', $key);
    }
    return self::$pathCache[$key];
}
```

---

### 5. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (Nice to Have)

#### 5.1 Wildcard –ø–æ–¥–¥–µ—Ä–∂–∫–∞
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```php
// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ö–æ—Å—Ç—ã –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
$hosts = Config::get('database.connections.*.host');
// ['mysql' => 'localhost', 'postgres' => '192.168.1.1']
```

#### 5.2 –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
```php
public static function export(string $format = 'array'): mixed
{
    return match($format) {
        'array' => self::all(),
        'json' => json_encode(self::all(), JSON_PRETTY_PRINT),
        'yaml' => yaml_emit(self::all()),
        'php' => var_export(self::all(), true),
        default => throw new InvalidArgumentException("Unsupported format: {$format}")
    };
}
```

#### 5.3 –°–æ–∑–¥–∞–Ω–∏–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ –æ–¥–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

```php
class Config
{
    private static ?self $instance = null;
    private array $items = [];
    
    public static function getInstance(): self
    {
        if (self::$instance === null) {
            self::$instance = new self();
        }
        return self::$instance;
    }
    
    public static function createInstance(): self
    {
        return new self();
    }
    
    // –í—Å–µ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Å $this->items –≤–º–µ—Å—Ç–æ self::$items
}
```

---

## –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –§–∞–∑–∞ 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ) - 1-2 –¥–Ω—è
1. ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç path traversal
2. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—É—Å—Ç—ã—Ö –∫–ª—é—á–µ–π
3. ‚úÖ –ú–µ—Ç–æ–¥ `getRequired()`
4. ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ edge case —Ç–µ—Å—Ç—ã

### –§–∞–∑–∞ 2 (–í–∞–∂–Ω–æ) - 2-3 –¥–Ω—è
1. ‚úÖ ArrayAccess –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
2. ‚úÖ –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –º–∞–∫—Ä–æ—Å–æ–≤
3. ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ JSON —Ñ–∞–π–ª–æ–≤
4. ‚úÖ –°–æ–±—ã—Ç–∏—è/—Ö—É–∫–∏

### –§–∞–∑–∞ 3 (–£–ª—É—á—à–µ–Ω–∏—è) - 3-5 –¥–Ω–µ–π
1. ‚è≥ –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2. ‚è≥ –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
3. ‚è≥ Wildcard –ø–æ–¥–¥–µ—Ä–∂–∫–∞
4. ‚è≥ –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ Config

```php
// 1. –£–¥–æ–±–Ω—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ ArrayAccess
$config = Config::getInstance();
$dbHost = $config['database.host'] ?? 'localhost';

// 2. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
$apiKey = Config::getRequired('api.secret_key');

// 3. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ
[$host, $port, $user] = array_values(Config::getMany([
    'database.host',
    'database.port',
    'database.username',
]));

// 4. –í–∞–ª–∏–¥–∞—Ü–∏—è
Config::validator('app.debug', fn($v) => is_bool($v));
Config::validator('database.port', fn($v) => $v > 0 && $v < 65536);
Config::load(__DIR__ . '/config');
Config::validate(); // Throws if invalid

// 5. –°–æ–±—ã—Ç–∏—è
Config::on('config.changed', function($data) {
    Logger::info("Config {$data['key']} changed");
});

// 6. –ú–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã (–¥–ª—è –¥–æ—Ä–æ–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)
Config::memoizedMacro('app.services', function() {
    return scanForServices(); // –í—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
});

// 7. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ JSON
Config::loadFile(__DIR__ . '/config/app.json');
Config::loadFile(__DIR__ . '/config/database.php');

// 8. –≠–∫—Å–ø–æ—Ä—Ç
file_put_contents('config.json', Config::export('json'));
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã (`tests/Unit/Core/ConfigEdgeCasesTest.php`):
- ‚úÖ Edge cases –¥–ª—è –∫–ª—é—á–µ–π (–ø—É—Å—Ç—ã–µ, —Å —Ç–æ—á–∫–∞–º–∏, unicode, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã)
- ‚úÖ Falsy –∑–Ω–∞—á–µ–Ω–∏—è (null, false, 0, –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ –ë–æ–ª—å—à–∏–µ –∏ –≥–ª—É–±–æ–∫–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ Edge cases –¥–ª—è –º–∞–∫—Ä–æ—Å–æ–≤
- ‚úÖ Edge cases –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –§–∞–π–ª—ã —Å side effects

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
./vendor/bin/pest tests/Unit/Core/ConfigTest.php
./vendor/bin/pest tests/Unit/Core/ConfigEdgeCasesTest.php
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í–∞—à –∫–ª–∞—Å—Å `Config` —É–∂–µ –Ω–∞ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ. –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
1. **–ü–æ–≤—ã—à–∞—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** (path traversal, circular refs)
2. **–£–ª—É—á—à–∞—é—Ç —É–¥–æ–±—Å—Ç–≤–æ** (ArrayAccess, getRequired, getMany)
3. **–î–æ–±–∞–≤–ª—è—é—Ç –≥–∏–±–∫–æ—Å—Ç—å** (JSON, —Å–æ–±—ã—Ç–∏—è, –≤–∞–ª–∏–¥–∞—Ü–∏—è)
4. **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É—é—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** (–º–µ–º–æ–∏–∑–∞—Ü–∏—è, –ª–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞)

–†–µ–∫–æ–º–µ–Ω–¥—É—é –Ω–∞—á–∞—Ç—å —Å **–§–∞–∑—ã 1** –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤–Ω–µ–¥—Ä—è—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.
