# –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ —É–ª—É—á—à–µ–Ω–∏–π

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. QueryBuilder (core/Database/QueryBuilder.php)
- **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ WHERE —É—Å–ª–æ–≤–∏—è:** whereIn, whereNull, orWhere, whereBetween, whereLike
- **–í–ª–æ–∂–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è:** –ø–æ–¥–¥–µ—Ä–∂–∫–∞ closure –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ú–∞—Å—Å–∏–≤ —É—Å–ª–æ–≤–∏–π:** –ø–µ—Ä–µ–¥–∞—á–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Å–ª–æ–≤–∏–π –º–∞—Å—Å–∏–≤–æ–º
- **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ JOIN:** leftJoin, rightJoin, crossJoin —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
- **GROUP BY –∏ HAVING:** –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–π
- **DISTINCT:** –≤—ã–±–æ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- **–ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:** count, sum, avg, max, min
- **–ü–∞–≥–∏–Ω–∞—Ü–∏—è:** –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- **INSERT/UPDATE/DELETE:** –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —á–µ—Ä–µ–∑ QueryBuilder
- **Helper –º–µ—Ç–æ–¥—ã:** latest, oldest, value, pluck, exists, take, skip
- **Debug –º–µ—Ç–æ–¥—ã:** dump, dd, toSql
- **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

### 2. DatabaseManager (core/Database/DatabaseManager.php)
- **Query Logging:** –ø–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –≤—Ä–µ–º–µ–Ω–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** –∞–Ω–∞–ª–∏–∑ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:** –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ë–î:** getTables, hasTable, getColumns, getDriverName
- **–£–ª—É—á—à–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:** –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –±–µ–∑–æ–ø–∞—Å–Ω—ã–π commit/rollback
- **–ó–∞—â–∏—Ç–∞ –ø–∞—Ä–æ–ª–µ–π:** –ø–∞—Ä–æ–ª–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ getConnectionInfo()

### 3. BaseModel (app/Models/BaseModel.php)
- **–ê—Ç—Ä–∏–±—É—Ç—ã –∏ Casts:** –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ (int, bool, json, datetime)
- **Accessors –∏ Mutators:** –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏/–∑–∞–ø–∏—Å–∏
- **Scopes:** Local –∏ Global scopes –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- **Soft Deletes:** –º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- **–°–æ–±—ã—Ç–∏—è:** hooks –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, —É–¥–∞–ª–µ–Ω–∏—è
- **Relationships:** –±–∞–∑–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ hasOne, hasMany, belongsTo, belongsToMany
- **Timestamps:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ created_at, updated_at
- **Fillable/Guarded:** –∑–∞—â–∏—Ç–∞ –æ—Ç mass assignment
- **Hidden:** —Å–∫—Ä—ã—Ç–∏–µ –ø–æ–ª–µ–π –≤ toArray/toJson
- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã:** —É–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–µ–ª—è–º–∏

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –§–∞–π–ª | –°—Ç—Ä–æ–∫ –±—ã–ª–æ | –°—Ç—Ä–æ–∫ —Å—Ç–∞–ª–æ | –î–æ–±–∞–≤–ª–µ–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π |
|------|------------|-------------|------------------------|
| QueryBuilder.php | 119 | 1100+ | 50+ –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤ |
| DatabaseManager.php | 241 | 600+ | 20+ –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤ |
| BaseModel.php | 117 | 700+ | 30+ –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤ |

## üß™ –¢–µ—Å—Ç—ã

–í—Å–µ —Ç–µ—Å—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ:
- ‚úÖ DatabaseManagerTest.php - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã 2 —Ç–µ—Å—Ç–∞
- ‚úÖ QueryBuilderTest.php - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã 6 —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- **docs/Database.md** - –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (500+ —Å—Ç—Ä–æ–∫)
- **examples/database_usage.php** - –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã (400+ —Å—Ç—Ä–æ–∫)
- **DATABASE_IMPROVEMENTS.md** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏–π
- **UPGRADE_SUMMARY.md** - —ç—Ç–∞ —Å–≤–æ–¥–∫–∞

## üöÄ –ö–∞–∫ –Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä:

```php
use Core\Database;

// –í–∫–ª—é—á–∞–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
Database::getInstance()->enableQueryLog();

// –°–ª–æ–∂–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å –Ω–æ–≤—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏
$users = Database::table('users')
    ->whereIn('status', ['active', 'pending'])
    ->whereNotNull('email_verified_at')
    ->where(function($query) {
        $query->where('age', '>=', 18)
              ->orWhere('verified', 1);
    })
    ->latest()
    ->paginate(1, 20);

// –ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
$count = Database::table('users')->count();
$avgAge = Database::table('users')->avg('age');

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
$stats = Database::getInstance()->getQueryStats();
```

### –†–∞–±–æ—Ç–∞ —Å –º–æ–¥–µ–ª—è–º–∏:

```php
use App\Models\User;

// –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å –Ω–æ–≤—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏
class User extends BaseModel
{
    protected array $fillable = ['name', 'email', 'age'];
    protected array $hidden = ['password'];
    protected array $casts = ['age' => 'int', 'settings' => 'json'];
    protected bool $softDeletes = true;
    
    // Scope
    public function scopeActive($query)
    {
        return $query->where('active', 1);
    }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
$users = User::active()->whereIn('country', ['USA', 'Canada'])->get();
$result = User::latest()->paginate(1, 15);
```

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç prepared statements
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è SQL
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –í–∫–ª—é—á–∞–π—Ç–µ query logging —Ç–æ–ª—å–∫–æ –Ω–∞ development

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –ø–æ–ª–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ `docs/Database.md`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ `examples/database_usage.php`
3. –û–±–Ω–æ–≤–∏—Ç–µ —Å–≤–æ–∏ –º–æ–¥–µ–ª–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
4. –í–∫–ª—é—á–∏—Ç–µ query logging –Ω–∞ development –æ–∫—Ä—É–∂–µ–Ω–∏–∏
5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–≥–∏–Ω–∞—Ü–∏—é –¥–ª—è –±–æ–ª—å—à–∏—Ö –≤—ã–±–æ—Ä–æ–∫
6. –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ scopes –¥–ª—è –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏ –ª–æ–≥–∏–∫–∏

## üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ –ë–æ–ª–µ–µ –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã–π –∏ —á–∏—Ç–∞–µ–º—ã–π –∫–æ–¥  
‚úÖ –ú–µ–Ω—å—à–µ raw SQL –∑–∞–ø—Ä–æ—Å–æ–≤  
‚úÖ –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å  
‚úÖ –ü—Ä–æ—Å—Ç–∞—è –æ—Ç–ª–∞–¥–∫–∞ —Å query logging  
‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç SQL injection  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ timestamps  
‚úÖ Soft deletes –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö  
‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—è "–∏–∑ –∫–æ—Ä–æ–±–∫–∏"  

---

**–í—Å–µ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã - —Å–º–æ—Ç—Ä–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ `docs/Database.md`
