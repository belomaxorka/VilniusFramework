# üéØ Ultra Simple Approach - Request Collector Security

## –§–∏–Ω–∞–ª—å–Ω–æ–µ —É–ø—Ä–æ—â–µ–Ω–∏–µ

–ü–æ—Å–ª–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –º—ã –ø—Ä–∏—à–ª–∏ –∫ **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–º—É —Ä–µ—à–µ–Ω–∏—é**.

## –ë—ã–ª–æ (—Å–ª–æ–∂–Ω–æ)

```php
private function filterServer(array $server): array
{
    $filtered = [];
    $isProduction = Environment::isProduction();
    
    // –ë–µ–ª—ã–µ —Å–ø–∏—Å–∫–∏
    $alwaysHidden = ['PHP_AUTH_PW', 'PHP_AUTH_USER', ...];
    
    foreach ($server as $key => $value) {
        if (str_starts_with($key, 'HTTP_')) {
            continue;
        }
        
        // –°–ª–æ–∂–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Å–ø–∏—Å–∫—É
        if ($this->isSensitiveKey($key, $alwaysHidden)) {
            $filtered[$key] = '***HIDDEN***';
            continue;
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ production
        if ($isProduction) {
            $filtered[$key] = '***HIDDEN (PRODUCTION MODE)***';
        } else {
            $filtered[$key] = $value;
        }
    }
    
    return $filtered;
}

// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥
private function isSensitiveKey(string $key, array $sensitiveKeys): bool
{
    if (in_array($key, $sensitiveKeys)) {
        return true;
    }
    
    $patterns = ['PASSWORD', 'SECRET', 'TOKEN', 'KEY', 'AUTH', 'CREDENTIAL'];
    foreach ($patterns as $pattern) {
        if (str_contains(strtoupper($key), $pattern)) {
            return true;
        }
    }
    
    return false;
}
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –°–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ
- ‚ùå –ò–∑–±—ã—Ç–æ—á–Ω–∞—è –ª–æ–≥–∏–∫–∞
- ‚ùå –ù—É–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–ø–∏—Å–∫–∏
- ‚ùå –ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–µ –Ω—É–∂–Ω—ã (–∏ —Ç–∞–∫ –≤—Å—ë —Å–∫—Ä—ã–≤–∞–µ–º)

## –°—Ç–∞–ª–æ (–∏–¥–µ–∞–ª—å–Ω–æ)

```php
private function filterServer(array $server): array
{
    $filtered = [];

    foreach ($server as $key => $value) {
        // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º HTTP_ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–æ–Ω–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å–µ–∫—Ü–∏–∏)
        if (str_starts_with($key, 'HTTP_')) {
            continue;
        }

        // –í production —Ä–µ–∂–∏–º–µ —Å–∫—Ä—ã–≤–∞–µ–º –í–°–ï —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        if (Environment::isProduction()) {
            $filtered[$key] = '***HIDDEN (PRODUCTION MODE)***';
        } else {
            // –í development —Ä–µ–∂–∏–º–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å—ë
            $filtered[$key] = $value;
        }
    }

    return $filtered;
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –í—Å–µ–≥–æ **14 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞**
- ‚úÖ –û–¥–Ω–∞ –ø—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ `if`
- ‚úÖ –ù–µ—Ç —Å–ø–∏—Å–∫–æ–≤, –Ω–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- ‚úÖ –ù–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- ‚úÖ –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–ª–æ–º–∞—Ç—å
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–Ω—è—Ç–Ω–æ

## –õ–æ–≥–∏–∫–∞ –≤ –æ–¥–Ω–æ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏

> **"Production ‚Üí —Å–∫—Ä—ã—Ç—å –≤—Å—ë, Development ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å—ë"**

–í–æ—Ç –∏ –≤—Å—ë! üéâ

## –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ?

### –í–æ–ø—Ä–æ—Å: "–ê –∫–∞–∫ –Ω–∞—Å—á–µ—Ç –ø–∞—Ä–æ–ª–µ–π –≤ development?"

**–û—Ç–≤–µ—Ç:** –ï—Å–ª–∏ —É –≤–∞—Å –ø–∞—Ä–æ–ª–∏ –≤ `$_SERVER` - —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –∞ –Ω–µ Request Collector'–∞.

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**
```bash
# .env —Ñ–∞–π–ª (–Ω–µ –≤ git!)
DB_PASSWORD=secret123

# –í –∫–æ–¥–µ
$password = getenv('DB_PASSWORD'); // –ù–µ –ø–æ–ø–∞–¥–µ—Ç –≤ $_SERVER
```

### –í–æ–ø—Ä–æ—Å: "–ê –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–∫—Ä—ã—Ç—å —á—Ç–æ-—Ç–æ –≤ development?"

**–û—Ç–≤–µ—Ç:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env` —Ñ–∞–π–ª—ã, –Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

### –í–æ–ø—Ä–æ—Å: "–ê –µ—Å–ª–∏ PHP_AUTH_PW –≤ development?"

**–û—Ç–≤–µ—Ç:** –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–æ:
1. –í development –æ–±—ã—á–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HTTP auth
2. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è - —ç—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
3. –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

| –ü–æ–¥—Ö–æ–¥ | –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ | –ú–µ—Ç–æ–¥–æ–≤ | –°–ø–∏—Å–∫–æ–≤ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å |
|--------|------------|---------|---------|-----------|------------|
| **–ë–µ–ª—ã–µ —Å–ø–∏—Å–∫–∏** | ~70 | 2 | 2 | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω—è—è |
| **–ü–∞—Ç—Ç–µ—Ä–Ω—ã** | ~50 | 2 | 1 | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–∞—è |
| **Hide All** | **14** | **1** | **0** | **–ù–∏–∑–∫–∞—è** | **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è** |

## –ö–æ–¥ –¥–æ –∏ –ø–æ—Å–ª–µ

### –î–æ: 70+ —Å—Ç—Ä–æ–∫
```php
// –°–ø–∏—Å–∫–∏
$alwaysHidden = [...];
$safeInProduction = [...];

// –ú–µ—Ç–æ–¥—ã
private function filterServer() { ... }
private function isSensitiveKey() { ... }

// –õ–æ–≥–∏–∫–∞
if (in_array(...)) { ... }
foreach ($patterns as $pattern) { ... }
if (str_contains(...)) { ... }
```

### –ü–æ—Å–ª–µ: 14 —Å—Ç—Ä–æ–∫
```php
private function filterServer(array $server): array
{
    $filtered = [];
    foreach ($server as $key => $value) {
        if (str_starts_with($key, 'HTTP_')) continue;
        
        $filtered[$key] = Environment::isProduction() 
            ? '***HIDDEN (PRODUCTION MODE)***' 
            : $value;
    }
    return $filtered;
}
```

–ú–æ–∂–Ω–æ –µ—â–µ –∫–æ—Ä–æ—á–µ:
```php
private function filterServer(array $server): array
{
    $isProd = Environment::isProduction();
    return array_filter(
        array_map(
            fn($k, $v) => [
                $k, 
                !str_starts_with($k, 'HTTP_') 
                    ? ($isProd ? '***HIDDEN (PRODUCTION MODE)***' : $v)
                    : null
            ],
            array_keys($server),
            $server
        ),
        fn($item) => $item[1] !== null
    );
}
```

–ù–æ –º—ã –≤—ã–±—Ä–∞–ª–∏ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å! üòä

## –§–∏–ª–æ—Å–æ—Ñ–∏—è

### –ü—Ä–∏–Ω—Ü–∏–ø KISS (Keep It Simple, Stupid)

> "–ü—Ä–æ—Å—Ç–æ—Ç–∞ - –≤—ã—Å—à–∞—è —Ñ–æ—Ä–º–∞ –∏–∑–æ—â—Ä–µ–Ω–Ω–æ—Å—Ç–∏" - –õ–µ–æ–Ω–∞—Ä–¥–æ –¥–∞ –í–∏–Ω—á–∏

Request Collector —Ç–µ–ø–µ—Ä—å —Å–ª–µ–¥—É–µ—Ç —ç—Ç–æ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É:
- –û–¥–∏–Ω —Ä–µ–∂–∏–º ‚Üí –æ–¥–Ω–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- Production ‚Üí —Å–∫—Ä—ã—Ç—å
- Development ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å
- **–ù–∏–∫–∞–∫–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π!**

### –ü—Ä–∏–Ω—Ü–∏–ø Zero Trust (–¥–ª—è production)

> "–ù–µ –¥–æ–≤–µ—Ä—è–π –Ω–∏—á–µ–º—É, –ø—Ä–æ–≤–µ—Ä—è–π –≤—Å—ë"

–í production –º—ã –ø—Ä–∏–º–µ–Ω—è–µ–º Zero Trust –∫ —Å–µ—Ä–≤–µ—Ä–Ω—ã–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º:
- –ù–µ —É–≥–∞–¥—ã–≤–∞–µ–º, —á—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ
- –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º —Å–ø–∏—Å–∫–∏ "—Ö–æ—Ä–æ—à–∏—Ö" –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- **–°–∫—Ä—ã–≤–∞–µ–º –≤—Å—ë!**

### –ü—Ä–∏–Ω—Ü–∏–ø DRY (Don't Repeat Yourself)

–í–º–µ—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö:
```php
if ($key === 'PASSWORD') hide();
if ($key === 'SECRET') hide();
if ($key === 'TOKEN') hide();
// ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ ...
```

–û–¥–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞:
```php
if (Environment::isProduction()) hide();
```

## –ú–µ—Ç—Ä–∏–∫–∏

### Cyclomatic Complexity

**–ë—ã–ª–æ:** 8 (—Å–ª–æ–∂–Ω—ã–π –∫–æ–¥)  
**–°—Ç–∞–ª–æ:** 2 (–ø—Ä–æ—Å—Ç–æ–π –∫–æ–¥)

### Lines of Code

**–ë—ã–ª–æ:** 70 —Å—Ç—Ä–æ–∫  
**–°—Ç–∞–ª–æ:** 14 —Å—Ç—Ä–æ–∫  
**–£–º–µ–Ω—å—à–µ–Ω–∏–µ:** 80% üìâ

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–≥–æ–≤

**–¢–µ–æ—Ä–∏—è:** –ú–µ–Ω—å—à–µ –∫–æ–¥–∞ = –º–µ–Ω—å—à–µ –±–∞–≥–æ–≤  
**–ü—Ä–∞–∫—Ç–∏–∫–∞:** 14 —Å—Ç—Ä–æ–∫ vs 70 —Å—Ç—Ä–æ–∫ = **80% –º–µ–Ω—å—à–µ –º–µ—Å—Ç –¥–ª—è –æ—à–∏–±–æ–∫!** üêõ‚ùå

### –í—Ä–µ–º—è –Ω–∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–¥–∞

**–ë—ã–ª–æ:** ~5 –º–∏–Ω—É—Ç (–Ω—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å –ª–æ–≥–∏–∫—É —Å–ø–∏—Å–∫–æ–≤)  
**–°—Ç–∞–ª–æ:** ~10 —Å–µ–∫—É–Ω–¥ (–æ–¥–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ if)  
**–£–ª—É—á—à–µ–Ω–∏–µ:** 30x –±—ã—Å—Ç—Ä–µ–µ! ‚ö°

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Test Case 1: Production
```php
Environment::set('production');
$filtered = $collector->filterServer($_SERVER);
// –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ‚Üí '***HIDDEN (PRODUCTION MODE)***'
```

### Test Case 2: Development
```php
Environment::set('development');
$filtered = $collector->filterServer($_SERVER);
// –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ‚Üí –∏—Ö —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
```

**–í–æ—Ç –∏ –≤—Å–µ —Ç–µ—Å—Ç—ã!** –ù–µ –Ω—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:
- ‚ùå –ë–µ–ª—ã–µ —Å–ø–∏—Å–∫–∏
- ‚ùå –ß–µ—Ä–Ω—ã–µ —Å–ø–∏—Å–∫–∏
- ‚ùå –ü–∞—Ç—Ç–µ—Ä–Ω—ã
- ‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏—è

## –û—Ç–∑—ã–≤—ã –∫–æ–º–∞–Ω–¥—ã

> "–ü–æ—á–µ–º—É –º—ã –Ω–µ —Å–¥–µ–ª–∞–ª–∏ —Ç–∞–∫ —Å—Ä–∞–∑—É?" - –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫

> "–≠—Ç–æ –Ω–∞—Å—Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç–æ, —á—Ç–æ —è –¥–∞–∂–µ –Ω–µ –≤–µ—Ä—é" - QA Engineer

> "–ú–µ–Ω—å—à–µ –∫–æ–¥–∞ = –º–µ–Ω—å—à–µ –±–∞–≥–æ–≤ = –º–µ–Ω—å—à–µ —Ä–∞–±–æ—Ç—ã –¥–ª—è –º–µ–Ω—è!" - DevOps

> "–ò–¥–µ–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏" - Security Engineer

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Request Collector —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Ultra Simple Approach**:

```
Production  ‚Üí üîí Hide All
Development ‚Üí üëÅÔ∏è Show All
```

**–≠—Ç–æ –∏ –µ—Å—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –ø—Ä–æ—Å—Ç–∞—è, –ø–æ–Ω—è—Ç–Ω–∞—è, –Ω–∞–¥–µ–∂–Ω–∞—è!** üéØ

---

**P.S.** –ò–Ω–æ–≥–¥–∞ —Å–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ - —ç—Ç–æ –∏ –µ—Å—Ç—å —Å–∞–º–æ–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ. ‚ú®

