# ๐ก๏ธ Dump Server Fallback - ะะฒัะพะผะฐัะธัะตัะบะพะต ะปะพะณะธัะพะฒะฐะฝะธะต

## ะงัะพ ััะพ?

ะขะตะฟะตัั ะตัะปะธ **Dump Server ะฝะตะดะพัััะฟะตะฝ**, ะดะฐะฝะฝัะต **ะฐะฒัะพะผะฐัะธัะตัะบะธ ะปะพะณะธัััััั** ะฒ ัะฐะนะป ะฒะผะตััะพ ัะพะณะพ ััะพะฑั ัะตัััััั!

---

## ๐ฏ ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั

### Dump Server ะทะฐะฟััะตะฝ โ
```php
server_dump($user, 'User Data');
```
โ ะะฐะฝะฝัะต ะพัะฟัะฐะฒะปััััั ะฒ **Dump Server** (real-time ะฒ ะบะพะฝัะพะปะธ)

### Dump Server ะพััะฐะฝะพะฒะปะตะฝ โ๏ธ
```php
server_dump($user, 'User Data');
```
โ ะะฐะฝะฝัะต **ะฐะฒัะพะผะฐัะธัะตัะบะธ ะปะพะณะธัััััั** ะฒ `storage/logs/dumps.log`  
โ ะัะตะดัะฟัะตะถะดะตะฝะธะต ะดะพะฑะฐะฒะปัะตััั ะฒ **Logger** (ะฟะพัะฒะปัะตััั ะฒ Debug Toolbar!)  
โ ะ CLI ะฒัะฒะพะดะธััั ะฟัะตะดัะฟัะตะถะดะตะฝะธะต ะฒ STDERR

**ะั ะฝะธัะตะณะพ ะฝะต ัะตััะตัะต!** ๐

---

## ๐จ Debug Toolbar ะธะฝัะตะณัะฐัะธั

ะะพะณะดะฐ Dump Server ะฝะตะดะพัััะฟะตะฝ, ะบะฐะถะดัะน `server_dump()` ัะพะทะดะฐัั ะทะฐะฟะธัั ะฒ Logger ั ััะพะฒะฝะตะผ **WARNING**.

### ะ Debug Toolbar ะฒั ัะฒะธะดะธัะต:

**ะะบะปะฐะดะบะฐ "Logs":**
```
[WARNING] Dump Server unavailable, data logged to file
  โโ label: User Data
  โโ type: array
  โโ file: app/Controllers/HomeController.php
  โโ line: 25
  โโ log_file: storage/logs/dumps.log
```

ะญัะพ ะฟะพะทะฒะพะปัะตั:
- โ ะะธะดะตัั ะฒัะต ะฟัะพะฑะปะตะผั ั Dump Server ะฒ ะพะดะฝะพะผ ะผะตััะต
- โ ะะฝะฐัั ะพัะบัะดะฐ ะฑัะปะธ ะฒัะทะฒะฐะฝั dumps
- โ ะััััะพ ะฝะฐะนัะธ ะปะพะณ-ัะฐะนะป ะดะปั ะฟัะพัะผะพััะฐ ะดะฐะฝะฝัั

---

## ๐ ะคะพัะผะฐั ะปะพะณะฐ

ะคะฐะนะป: `storage/logs/dumps.log`

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
[2025-10-03 13:15:42] ๐ User Data | ๐ Type: array | ๐ app/Controllers/HomeController.php:25
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
array(
  "id" => 123,
  "name" => "John Doe",
  "email" => "john@example.com",
  "roles" => array(
    0 => "admin",
    1 => "editor",
  ),
)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
[2025-10-03 13:15:43] ๐ Config | ๐ Type: array | ๐ app/Controllers/HomeController.php:30
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
...
```

**ะกะพะดะตัะถะธั:**
- โ Timestamp
- โ Label
- โ ะขะธะฟ ะดะฐะฝะฝัั
- โ ะคะฐะนะป ะธ ัััะพะบะฐ
- โ ะะพะปะฝัะต ะดะฐะฝะฝัะต

---

## ๐ฎ ะะพะผะฐะฝะดั ะดะปั ัะฐะฑะพัั ั ะปะพะณะฐะผะธ

### ะัะพัะผะพััะตัั ะฒัะต ะปะพะณะธ
```bash
php vilnius dump:log
```

### ะะพัะปะตะดะฝะธะต 10 ะทะฐะฟะธัะตะน
```bash
php vilnius dump:log --tail=10
php vilnius dump:log -n 10
```

### ะัะธััะธัั ะปะพะณะธ
```bash
php vilnius dump:log --clear
php vilnius dump:log -c
```

---

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะขะตัั 1: CLI ัะบัะธะฟั

#### ะจะฐะณ 1: ะฃะฑะตะดะธัะตัั ััะพ Dump Server ะพััะฐะฝะพะฒะปะตะฝ

ะัะปะธ ะพะฝ ะทะฐะฟััะตะฝ - ะฝะฐะถะผะธัะต `Ctrl+C`

#### ะจะฐะณ 2: ะะฐะฟัััะธัะต ัะตัั

```bash
php test-dump-fallback.php
```

**ะัะฒะพะด:**
```
๐งช ะขะตัั Fallback ะผะตัะฐะฝะธะทะผะฐ Dump Server
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ Dump Server ะฝะตะดะพัััะฟะตะฝ - fallback ะฐะบัะธะฒะธัะพะฒะฐะฝ!

๐ค ะัะฟัะฐะฒะบะฐ ะดะฐะฝะฝัั...

โ๏ธ  Dump Server unavailable, logged to: storage/logs/dumps.log
โ๏ธ  Dump Server unavailable, logged to: storage/logs/dumps.log
...

โ ะะฐะฝะฝัะต ะพัะฟัะฐะฒะปะตะฝั!

๐ ะะฐะฝะฝัะต ัะพััะฐะฝะตะฝั ะฒ ะปะพะณ-ัะฐะนะป:
   C:\OSPanel\home\torrentpier\public\storage\logs\dumps.log

๐ ะัะพัะผะพััะตัั ะปะพะณะธ:
   php vilnius dump:log              # ะะตัั ะปะพะณ
   php vilnius dump:log --tail=5     # ะะพัะปะตะดะฝะธะต 5 ะทะฐะฟะธัะตะน
   php vilnius dump:log --clear      # ะัะธััะธัั ะปะพะณ
```

#### ะจะฐะณ 3: ะัะพัะผะพััะธัะต ะปะพะณะธ

```bash
php vilnius dump:log --tail=5
```

ะั ัะฒะธะดะธัะต ะฒัะต dumps ะบะพัะพััะต ะฑัะปะธ ะพัะฟัะฐะฒะปะตะฝั!

---

### ะขะตัั 2: Web + Debug Toolbar

#### ะจะฐะณ 1: ะะฐะฟัััะธัะต ะฒะตะฑ-ัะตัะฒะตั

```bash
php -S localhost:8000 -t public
```

#### ะจะฐะณ 2: ะัะบัะพะนัะต ัะตััะพะฒัั ัััะฐะฝะธัั

ะัะบัะพะนัะต ะฒ ะฑัะฐัะทะตัะต: `http://localhost:8000/test-dump-debug-toolbar.php`

#### ะจะฐะณ 3: ะัะพะฒะตัััะต Debug Toolbar

1. ะัะบัะพะนัะต **Debug Toolbar** (ะฒะฝะธะทั ัััะฐะฝะธัั)
2. ะะตัะตะนะดะธัะต ะฝะฐ ะฒะบะปะฐะดะบั **"Logs"**
3. ะั ัะฒะธะดะธัะต ะทะฐะฟะธัะธ ััะพะฒะฝั **WARNING**:
   ```
   [WARNING] Dump Server unavailable, data logged to file
   ```
4. ะะฐะถะดะฐั ะทะฐะฟะธัั ัะพะดะตัะถะธั ะบะพะฝัะตะบัั ั ะธะฝัะพัะผะฐัะธะตะน ะพ dump'ะต

#### ะงัะพ ะฒั ัะฒะธะดะธัะต:

**ะะฐ ัััะฐะฝะธัะต:**
- โ ะะพะดัะฒะตัะถะดะตะฝะธะต ััะพ dumps ะพัะฟัะฐะฒะปะตะฝั
- โน๏ธ ะะฝัะพัะผะฐัะธั ะพ fallback ะผะตัะฐะฝะธะทะผะต
- ๐ ะะฝััััะบัะธะธ ะฟะพ ะฟัะพัะผะพััั

**ะ Debug Toolbar (ะฒะบะปะฐะดะบะฐ Logs):**
- โ๏ธ 3 ะฟัะตะดัะฟัะตะถะดะตะฝะธั ะพ ะฝะตะดะพัััะฟะฝะพััะธ Dump Server
- ๐ ะะตัะฐะปัะฝะฐั ะธะฝัะพัะผะฐัะธั ะพ ะบะฐะถะดะพะผ dump'ะต
- ๐ ะััั ะบ ะปะพะณ-ัะฐะนะปั

---

## ๐ก ะะฐะฑะพัะธะน ะฟัะพัะตัั

### Development (ั Dump Server)

**Terminal 1:**
```bash
php vilnius dump-server
```

**Terminal 2:**
```bash
php -S localhost:8000 -t public
```

ะัะต `server_dump()` ะธะดัั ะฒ **Terminal 1** (real-time).

---

### Development (ะฑะตะท Dump Server)

**Terminal 1:**
```bash
php -S localhost:8000 -t public
```

ะัะต `server_dump()` ะธะดัั ะฒ **`storage/logs/dumps.log`**.

ะัะพัะผะพัั:
```bash
php vilnius dump:log --tail=10
```

---

### Production

ะ production `APP_DEBUG=false`, ะฟะพััะพะผั `server_dump()` **ะฝะธัะตะณะพ ะฝะต ะดะตะปะฐะตั**.

---

## ๐จ CLI ัะฒะตะดะพะผะปะตะฝะธั

### ะ CLI ัะบัะธะฟัะฐั

ะะพะณะดะฐ ะฒั ะทะฐะฟััะบะฐะตัะต PHP CLI ัะบัะธะฟั ะธ dump server ะฝะตะดะพัััะฟะตะฝ:

```bash
php some-script.php
โ๏ธ  Dump Server unavailable, logged to: storage/logs/dumps.log
```

### ะ Web ะทะฐะฟัะพัะฐั

ะะพะณะธัะพะฒะฐะฝะธะต ะฟัะพะธััะพะดะธั **ัะธัะพ**, ะฑะตะท ะฒัะฒะพะดะฐ ะฒ ะฑัะฐัะทะตั.

---

## ๐ง ะะพะฝัะธะณััะฐัะธั

### ะัะบะปััะธัั fallback ะปะพะณะธัะพะฒะฐะฝะธะต

ะัะปะธ ะฝะต ัะพัะธัะต ะปะพะณะธัะพะฒะฐัั ะฒ ัะฐะนะป:

```php
// ะ core/DumpClient.php::logToFile()
// ะะฐะบะพะผะผะตะฝัะธััะนัะต ัะพะดะตัะถะธะผะพะต ะผะตัะพะดะฐ ะธะปะธ ะดะพะฑะฐะฒััะต ะฟัะพะฒะตัะบั
```

### ะะทะผะตะฝะธัั ะฟััั ะบ ะปะพะณั

```php
// ะ core/DumpClient.php::logToFile()
$logFile = $logDir . '/custom-dumps.log';
```

### ะะพัะฐัะธั ะปะพะณะพะฒ

ะะปั ัะพัะฐัะธะธ ะฑะพะปััะธั ะปะพะณะพะฒ ะดะพะฑะฐะฒััะต ะฒ cron:

```bash
# ะะฐะถะดัะน ะดะตะฝั ะฒ ะฟะพะปะฝะพัั
0 0 * * * php /path/to/project/vilnius dump:log --clear
```

ะะปะธ ัะพะทะดะฐะนัะต ะบะพะผะฐะฝะดั ะดะปั ัะพัะฐัะธะธ:

```bash
php vilnius dump:log --clear  # ะััะฝะฐั ะพัะธััะบะฐ
```

---

## ๐ ะกัะฐัะธััะธะบะฐ

### ะะพัะผะพััะตัั ัะฐะทะผะตั ะปะพะณะฐ

```bash
php vilnius dump:log
```

ะะพะบะฐะถะตั:
```
Dump Server Logs:
File: C:\OSPanel\home\torrentpier\public\storage\logs\dumps.log
Size: 15.42 KB

[ัะพะดะตัะถะธะผะพะต]
```

---

## ๐ฏ ะกัะตะฝะฐัะธะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### 1. ะะฐะฑัะปะธ ะทะฐะฟัััะธัั Dump Server

```php
// ะ ะบะพะดะต
server_dump($user, 'Debug user');
```

**ะะตะท fallback:** โ ะะฐะฝะฝัะต ะฟะพัะตััะฝั  
**ะก fallback:** โ ะะฐะฝะฝัะต ะฒ ะปะพะณะต

---

### 2. Dump Server ัะฟะฐะป

```php
// ะะฝะพะณะพ dumps ะฒ ัะธะบะปะต
foreach ($users as $user) {
    server_dump($user, "User {$user['id']}");
}
```

ะัะปะธ ัะตัะฒะตั ัะฟะฐะดัั ะฒะพ ะฒัะตะผั ะฒัะฟะพะปะฝะตะฝะธั - ะพััะฐะปัะฝัะต dumps ัะพััะฐะฝัััั ะฒ ะปะพะณ!

---

### 3. ะัะปะฐะดะบะฐ ะฑะตะท ะฒัะพัะพะณะพ ัะตัะผะธะฝะฐะปะฐ

ะะต ัะพัะธัะต ะดะตัะถะฐัั ะพัะบััััะผ ะฒัะพัะพะน ัะตัะผะธะฝะฐะป ั dump server?

ะัะพััะพ ะฝะต ะทะฐะฟััะบะฐะนัะต ะตะณะพ - ะฒัั ะฟะพะนะดัั ะฒ ะปะพะณ:

```bash
# ะะฐะทัะฐะฑะพัะบะฐ
php -S localhost:8000 -t public

# ะัะปะฐะดะบะฐ
php vilnius dump:log --tail=20
```

---

### 4. ะกะพััะฐะฝะตะฝะธะต ะธััะพัะธะธ

ะะพะณะธ ะพััะฐัััั ะฒ ัะฐะนะปะต, ะผะพะถะฝะพ ะฒะตัะฝััััั ะฟะพะทะถะต:

```bash
# ะฃััะพะผ
server_dump($data1);
server_dump($data2);

# ะะตัะตัะพะผ
php vilnius dump:log  # ะัั ะตัั ัะฐะผ!
```

---

## โ๏ธ ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ

### ะัะธะพัะธัะตั

1. **ะะพะฟััะบะฐ ะพัะฟัะฐะฒะธัั ะฒ Dump Server** (TCP 127.0.0.1:9912)
2. **ะัะปะธ ะฝะต ัะดะฐะปะพัั** โ ะปะพะณะธัะพะฒะฐะฝะธะต ะฒ ัะฐะนะป
3. **CLI:** ะฒัะฒะพะด ะฟัะตะดัะฟัะตะถะดะตะฝะธั ะฒ STDERR
4. **Web:** ัะธัะพะต ะปะพะณะธัะพะฒะฐะฝะธะต

### ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

- Fallback ะฝะต ะฑะปะพะบะธััะตั ะฒัะฟะพะปะฝะตะฝะธะต
- ะัะฟะพะปัะทัะตั `FILE_APPEND | LOCK_EX` ะดะปั ะฑะตะทะพะฟะฐัะฝะพะน ะทะฐะฟะธัะธ
- ะัะธะฑะบะธ ะทะฐะฟะธัะธ ะธะณะฝะพัะธัััััั (graceful degradation)

### ะะตะทะพะฟะฐัะฝะพััั

- ะะพะณะธ ัะพะทะดะฐัััั ะฒ `storage/logs/` (ะฒะฝะต `public/`)
- ะัะฐะฒะฐ ะดะพัััะฟะฐ: `0755` ะดะปั ะดะธัะตะบัะพัะธะธ
- ะ production (`APP_DEBUG=false`) ะฝะธัะตะณะพ ะฝะต ะปะพะณะธััะตััั

---

## ๐ ะกัะฐะฒะฝะตะฝะธะต

| ะกะธััะฐัะธั | ะะตะท Fallback | ะก Fallback |
|----------|---------------|------------|
| Dump Server ะทะฐะฟััะตะฝ | โ Real-time | โ Real-time |
| Dump Server ะพััะฐะฝะพะฒะปะตะฝ | โ ะะฐะฝะฝัะต ะฟะพัะตััะฝั | โ ะะพะณะธัััััั ะฒ ัะฐะนะป |
| ะกะตัะฒะตั ัะฟะฐะป | โ ะะฐะฝะฝัะต ะฟะพัะตััะฝั | โ ะััะฐะปัะฝัะต ะฒ ัะฐะนะป |
| Production | โ ะะต ัะฐะฑะพัะฐะตั | โ ะะต ัะฐะฑะพัะฐะตั (ะฟัะฐะฒะธะปัะฝะพ) |

---

## ๐ Best Practices

### โ ะะ:

```php
// Real-time ะพัะปะฐะดะบะฐ - ะทะฐะฟัััะธัะต dump server
server_dump($data);

// ะะพัะพะผ ะฟัะพัะผะพััะธัะต ััะพ ะฟัะพะฟัััะธะปะธ
php vilnius dump:log --tail=50
```

### โ ะะ:

```php
// ะัะปะฐะดะบะฐ ะฑะตะท ะปะธัะฝะธั ัะตัะผะธะฝะฐะปะพะฒ
// ะัะพััะพ ะฝะต ะทะฐะฟััะบะฐะนัะต dump server
server_dump($data);

// ะะตัะธะพะดะธัะตัะบะธ ัะผะพััะธัะต ะปะพะณ
php vilnius dump:log
```

### โ ะะ:

```php
// ะัะธัะฐะนัะต ะปะพะณะธ ัะตะณัะปััะฝะพ
php vilnius dump:log --clear
```

### โ ะะะข:

```php
// ะะต ััะฐะฝะธัะต ะปะพะณะธ ัะปะธัะบะพะผ ะดะพะปะณะพ (ะผะพะณัั ัะฐะทัะฐััะธัั)
// ะัะธัะฐะนัะต ะธั ะฟะตัะธะพะดะธัะตัะบะธ
```

---

## ๐ฆ ะัะพะณะพ

### ะงัะพ ะดะพะฑะฐะฒะปะตะฝะพ:

1. โ **ะะฒัะพะผะฐัะธัะตัะบะธะน fallback** - ะปะพะณะธัะพะฒะฐะฝะธะต ะฒ ัะฐะนะป
2. โ **ะะพะผะฐะฝะดะฐ `dump:log`** - ะฟัะพัะผะพัั ะปะพะณะพะฒ
3. โ **CLI ะฟัะตะดัะฟัะตะถะดะตะฝะธั** - ะฒะธะดะฝะพ ััะพ ัะตัะฒะตั ะฝะตะดะพัััะฟะตะฝ
4. โ **Graceful degradation** - ะพัะธะฑะบะธ ะฝะต ะปะพะผะฐัั ะฟัะธะปะพะถะตะฝะธะต

### ะขะตะฟะตัั ั ะฒะฐั:

- ๐ก๏ธ **ะะฐะดัะถะฝะพััั** - ะดะฐะฝะฝัะต ะฝะต ัะตัััััั
- ๐ **ะััะพัะธั** - ะผะพะถะฝะพ ะฒะตัะฝััััั ะบ ััะฐััะผ dumps
- ๐ **ะะธะฑะบะพััั** - ัะฐะฑะพัะฐะตั ั ัะตัะฒะตัะพะผ ะธ ะฑะตะท
- ๐ฏ **ะฃะดะพะฑััะฒะพ** - ะฟัะพัะผะพัั ัะตัะตะท CLI

---

**ะะพะปััะต ะฝะธะบะฐะบะธั ะฟะพัะตััะฝะฝัั dumps! ๐**

