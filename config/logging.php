<?php declare(strict_types=1);

/**
 * Конфигурация системы логирования
 * 
 * Поддерживаемые драйверы:
 * - file: запись логов в файл
 * - slack: отправка логов в Slack
 * - telegram: отправка логов в Telegram
 */

return [
    /*
    |--------------------------------------------------------------------------
    | Драйвер логирования по умолчанию
    |--------------------------------------------------------------------------
    |
    | Определяет какой драйвер будет использоваться по умолчанию
    |
    */
    'default' => env('LOG_CHANNEL', 'file'),

    /*
    |--------------------------------------------------------------------------
    | Минимальный уровень логирования
    |--------------------------------------------------------------------------
    |
    | Минимальный уровень логов, которые будут записываться
    | Доступные уровни: debug, info, warning, error, critical
    |
    */
    'min_level' => env('LOG_LEVEL', 'debug'),

    /*
    |--------------------------------------------------------------------------
    | Активные каналы логирования
    |--------------------------------------------------------------------------
    |
    | Список активных каналов. Логи будут отправляться во все активные каналы.
    | Оставьте пустым [], чтобы использовать только default драйвер.
    | Или укажите массив драйверов: ['file', 'slack', 'telegram']
    |
    */
    'channels' => env('LOG_CHANNELS', 'file'),  // Можно: 'file' или 'file,slack,telegram'

    /*
    |--------------------------------------------------------------------------
    | Конфигурация драйверов
    |--------------------------------------------------------------------------
    |
    | Настройки для каждого драйвера логирования
    |
    */
    'drivers' => [
        
        /*
        |--------------------------------------------------------------------------
        | File Driver
        |--------------------------------------------------------------------------
        */
        'file' => [
            'driver' => 'file',
            'path' => env('LOG_FILE', LOG_DIR . '/app.log'),
            'min_level' => env('LOG_FILE_LEVEL', 'debug'),
            'max_size' => env('LOG_FILE_MAX_SIZE', 10485760), // 10MB в байтах
        ],

        /*
        |--------------------------------------------------------------------------
        | Slack Driver
        |--------------------------------------------------------------------------
        | 
        | Для работы необходимо создать Incoming Webhook в Slack:
        | https://api.slack.com/messaging/webhooks
        |
        */
        'slack' => [
            'driver' => 'slack',
            'webhook_url' => env('LOG_SLACK_WEBHOOK_URL', ''),
            'channel' => env('LOG_SLACK_CHANNEL', '#logs'),
            'username' => env('LOG_SLACK_USERNAME', 'Logger Bot'),
            'emoji' => env('LOG_SLACK_EMOJI', ':robot_face:'),
            'min_level' => env('LOG_SLACK_LEVEL', 'error'), // Только ошибки в Slack
        ],

        /*
        |--------------------------------------------------------------------------
        | Telegram Driver
        |--------------------------------------------------------------------------
        |
        | Для работы необходимо создать бота через @BotFather и получить:
        | - Bot Token
        | - Chat ID (можно получить через @userinfobot)
        |
        */
        'telegram' => [
            'driver' => 'telegram',
            'bot_token' => env('LOG_TELEGRAM_BOT_TOKEN', ''),
            'chat_id' => env('LOG_TELEGRAM_CHAT_ID', ''),
            'min_level' => env('LOG_TELEGRAM_LEVEL', 'error'), // Только ошибки в Telegram
            'parse_mode' => env('LOG_TELEGRAM_PARSE_MODE', 'HTML'), // HTML или Markdown
        ],

    ],
];
