# üîí –§–∏–Ω–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Request Collector

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### –§–∏–ª–æ—Å–æ—Ñ–∏—è "Hide All" –≤ Production

Request Collector —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–¥—Ö–æ–¥ **"—Å–∫—Ä—ã—Ç—å –≤—Å—ë"** –≤ production —Ä–µ–∂–∏–º–µ –≤–º–µ—Å—Ç–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –±–µ–ª—ã–µ/—á–µ—Ä–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

## üéØ –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ë—ã–ª–æ (—Å–ª–æ–∂–Ω–æ):**
```php
// –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ "–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö" –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
$safeInProduction = ['REQUEST_METHOD', 'REQUEST_URI', ...];

// –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ "–æ–ø–∞—Å–Ω—ã—Ö" –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö  
$alwaysHidden = ['PASSWORD', 'SECRET', 'TOKEN', ...];

// –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
if (in_array($key, $safeInProduction)) { ... }
```

**–°—Ç–∞–ª–æ (–ø—Ä–æ—Å—Ç–æ):**
```php
// –í production —Ä–µ–∂–∏–º–µ —Å–∫—Ä—ã–≤–∞–µ–º –í–°–Å
if ($isProduction) {
    $filtered[$key] = '***HIDDEN (PRODUCTION MODE)***';
}
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ UI

**–ë—ã–ª–æ:**
```
‚ö†Ô∏è Production Mode: Sensitive server variables are hidden for security reasons.
   Only safe variables are shown.
```

**–°—Ç–∞–ª–æ:**
```
‚ö†Ô∏è Production Mode: All server variables are hidden for security reasons.
   Server variables are only visible in development mode.
```

### 3. –ö–æ–¥ —Å—Ç–∞–ª –ø—Ä–æ—â–µ –∏ –Ω–∞–¥–µ–∂–Ω–µ–µ

**–£–¥–∞–ª–µ–Ω–æ:**
- ‚ùå –ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ `$safeInProduction` (–Ω–µ –Ω—É–∂–µ–Ω)
- ‚ùå –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ (—É–ø—Ä–æ—â–µ–Ω)
- ‚ùå –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏

**–û—Å—Ç–∞–ª–æ—Å—å:**
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ `Environment::isProduction()`
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (PHP_AUTH_PW, etc.)
- ‚úÖ –ü–∞—Ç—Ç–µ—Ä–Ω-matching –¥–ª—è –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

## üìä –¢–∞–±–ª–∏—Ü–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

| –†–µ–∂–∏–º       | Development        | Production         |
|-------------|--------------------|--------------------|
| **–í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** | ‚úÖ –í–∏–¥–Ω—ã    | üîí **–°–∫—Ä—ã—Ç—ã**      |
| PHP_AUTH_PW | üîí –°–∫—Ä—ã—Ç–∞          | üîí –°–∫—Ä—ã—Ç–∞          |
| *_PASSWORD  | üîí –°–∫—Ä—ã—Ç–∞          | üîí –°–∫—Ä—ã—Ç–∞          |
| *_SECRET    | üîí –°–∫—Ä—ã—Ç–∞          | üîí –°–∫—Ä—ã—Ç–∞          |
| *_TOKEN     | üîí –°–∫—Ä—ã—Ç–∞          | üîí –°–∫—Ä—ã—Ç–∞          |

## üí° –ü–æ—á–µ–º—É —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥?

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ "Hide All"

1. **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
   - –ù–µ—Ç —Ä–∏—Å–∫–∞ –∑–∞–±—ã—Ç—å –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
   - –ó–∞—â–∏—Ç–∞ –æ—Ç —É—Ç–µ—á–∫–∏ –Ω–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ custom –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏

2. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∫–æ–¥–∞**
   - –ú–µ–Ω—å—à–µ –∫–æ–¥–∞ = –º–µ–Ω—å—à–µ –±–∞–≥–æ–≤
   - –ù–µ –Ω—É–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –¥–ª–∏–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏
   - –õ–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å

3. **–ë—É–¥—É—â–µ–µ-proof**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—â–∏—â–∞–µ—Ç –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
   - –ù–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏

4. **Zero-trust –ø–æ–¥—Ö–æ–¥**
   - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
   - –ù–µ —É–≥–∞–¥—ã–≤–∞–µ–º, –∞ —Å–∫—Ä—ã–≤–∞–µ–º
   - –°–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º security

### ‚ùå –ß—Ç–æ –±—ã–ª–æ –Ω–µ —Ç–∞–∫ —Å –±–µ–ª—ã–º–∏ —Å–ø–∏—Å–∫–∞–º–∏?

1. **–ù–µ–Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å**
   - –õ–µ–≥–∫–æ –∑–∞–±—ã—Ç—å –¥–æ–±–∞–≤–∏—Ç—å –æ–ø–∞—Å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
   - –û–∫—Ä—É–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –±–µ–∑ –Ω–∞—à–µ–≥–æ –≤–µ–¥–æ–º–∞
   - –†–∞–∑–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã = —Ä–∞–∑–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

2. **–°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏**
   - –ù—É–∂–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–ø–∏—Å–∫–∏
   - –°–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
   - –ë–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –¥–ª—è –æ—à–∏–±–æ–∫

3. **–õ–æ–∂–Ω–æ–µ —á—É–≤—Å—Ç–≤–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
   - "–≠—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∫–∞–∂–µ—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π"
   - –ù–æ –∫—Ç–æ –∑–Ω–∞–µ—Ç, —á—Ç–æ —Ç–∞–º –≤ production?
   - –õ—É—á—à–µ –ø–µ—Ä–µ—Å—Ç—Ä–∞—Ö–æ–≤–∞—Ç—å—Å—è

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–π –∫–æ–¥

**core/DebugToolbar/Collectors/RequestCollector.php**

```php
private function filterServer(array $server): array
{
    $filtered = [];
    
    // –í production —Ä–µ–∂–∏–º–µ —Å–∫—Ä—ã–≤–∞–µ–º –í–°–ï –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    $isProduction = Environment::isProduction();
    
    // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö (—Å–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ–≥–¥–∞)
    $alwaysHidden = [
        'PHP_AUTH_PW',
        'PHP_AUTH_USER',
        'HTTP_AUTHORIZATION',
    ];

    foreach ($server as $key => $value) {
        // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º HTTP_ –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å–µ–∫—Ü–∏–∏)
        if (str_starts_with($key, 'HTTP_')) {
            continue;
        }

        // –í—Å–µ–≥–¥–∞ —Å–∫—Ä—ã–≤–∞–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
        if ($this->isSensitiveKey($key, $alwaysHidden)) {
            $filtered[$key] = '***HIDDEN***';
            continue;
        }

        // –í production —Å–∫—Ä—ã–≤–∞–µ–º –í–°–Å!
        if ($isProduction) {
            $filtered[$key] = '***HIDDEN (PRODUCTION MODE)***';
        } else {
            $filtered[$key] = $value;
        }
    }

    return $filtered;
}
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```
–°—Ç—Ä–æ–∫ –∫–æ–¥–∞: -30 (—É–ø—Ä–æ—â–µ–Ω–∏–µ!)
–°–ª–æ–∂–Ω–æ—Å—Ç—å: –ù–∏–∑–∫–∞—è (–±—ã–ª–æ: –°—Ä–µ–¥–Ω—è—è)
–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è (–±—ã–ª–æ: –í—ã—Å–æ–∫–∞—è)
–ü–æ–¥–¥–µ—Ä–∂–∫–∞: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è (–±—ã–ª–æ: –¢—Ä–µ–±–æ–≤–∞–ª–∞—Å—å)
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Development Mode

```bash
export APP_ENV=development
php -S localhost:8000
# –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000/demo
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
- ‚úÖ –í—Å–µ Server Variables –≤–∏–¥–Ω—ã
- üîí –¢–æ–ª—å–∫–æ PHP_AUTH_PW, *_PASSWORD, *_SECRET —Å–∫—Ä—ã—Ç—ã

### Production Mode

```bash
export APP_ENV=production
php -S localhost:8000
# –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000/demo
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
- üîí **–í–°–ï** Server Variables —Å–∫—Ä—ã—Ç—ã
- üî¥ –ö—Ä–∞—Å–Ω—ã–π badge "PRODUCTION MODE"
- ‚ö†Ô∏è Warning message

## üìö –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

- ‚úÖ `core/DebugToolbar/Collectors/RequestCollector.php` - —É–ø—Ä–æ—â–µ–Ω–∞ –ª–æ–≥–∏–∫–∞
- ‚úÖ `docs/RequestCollectorSecurity.md` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è
- ‚úÖ `docs/RequestCollector.md` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ `REQUEST_COLLECTOR_CHANGES.md` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è
- ‚úÖ `SECURITY_UPDATE.md` - –æ–±–Ω–æ–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ
- ‚úÖ `FINAL_SECURITY_SUMMARY.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª

## üéì Best Practices

### ‚úÖ DO (–î–µ–ª–∞–π—Ç–µ)

1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `APP_ENV=production` –Ω–∞ –±–æ–µ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö
2. –û—Ç–∫–ª—é—á–∞–π—Ç–µ Debug Toolbar –≤ production (`APP_DEBUG=false`)
3. –î–æ–≤–µ—Ä—è–π—Ç–µ –ø—Ä–∏–Ω—Ü–∏–ø—É "Hide All"
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ development –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### ‚ùå DON'T (–ù–µ –¥–µ–ª–∞–π—Ç–µ)

1. –ù–µ –ø—ã—Ç–∞–π—Ç–µ—Å—å "—É–ª—É—á—à–∏—Ç—å" –±–µ–ª—ã–º–∏ —Å–ø–∏—Å–∫–∞–º–∏
2. –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ production
3. –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –±–µ–∑ –∑–∞—â–∏—Ç—ã
4. –ù–µ –æ—Å—Ç–∞–≤–ª—è–π—Ç–µ Debug Toolbar –≤–∫–ª—é—á–µ–Ω–Ω—ã–º –≤ production

## üéØ –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### –†–∞–Ω—å—à–µ –º—ã –¥—É–º–∞–ª–∏:
> "–î–∞–≤–∞–π—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏–º, –∫–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã"

### –¢–µ–ø–µ—Ä—å –º—ã –∑–Ω–∞–µ–º:
> "–í production –Ω–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö - —Å–∫—Ä—ã–≤–∞–µ–º –≤—Å—ë!"

### –†–µ–∑—É–ª—å—Ç–∞—Ç:

‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞** - –∫–æ–¥ —Å—Ç–∞–ª –ø—Ä–æ—â–µ  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∑–∞—â–∏—Ç–∞ —É—Å–∏–ª–∏–ª–∞—Å—å  
‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –Ω–µ –∑–∞–≤–∏—Å–∏–º –æ—Ç —Å–ø–∏—Å–∫–æ–≤  
‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –º–µ–Ω—å—à–µ –ø—Ä–æ–≤–µ—Ä–æ–∫  
‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞** - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª—è—Ç—å  

## üöÄ –ò—Ç–æ–≥–æ

Request Collector —Ç–µ–ø–µ—Ä—å —Å–ª–µ–¥—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—É **"Zero Trust"** –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

```
Development = Trust (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å—ë –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
Production  = Zero Trust (—Å–∫—Ä—ã–≤–∞–µ–º –≤—Å—ë –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
```

–≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, –Ω–∞–¥–µ–∂–Ω—ã–π –∏ –ø—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Ö–æ–¥ –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!

---

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∞. –ö–æ–¥ —É–ø—Ä–æ—â–µ–Ω. –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç! üîê‚ú®**

